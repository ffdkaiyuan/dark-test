<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é»‘æš—äººæ ¼æµ‹è¯• | æ·±åº¦å¿ƒç†åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1525 50%, #0d0d15 100%);
            min-height: 100vh;
            color: #f0f0f5;
            overflow-x: hidden;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, rgba(180, 60, 120, 0.6) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 15s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-30px) rotate(180deg); opacity: 0.8; }
        }

        .container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            max-width: 480px;
            margin: 0 auto;
        }

        .home-content {
            width: 100%;
            max-width: 380px;
            text-align: center;
        }

        .logo-area {
            margin-bottom: 35px;
        }

        .logo-icon {
            width: 90px;
            height: 90px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, rgba(180, 50, 100, 0.3) 0%, rgba(100, 40, 120, 0.3) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            box-shadow: 0 0 40px rgba(160, 50, 110, 0.3);
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 40px rgba(160, 50, 110, 0.3);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 60px rgba(160, 50, 110, 0.5);
            }
        }

        .main-title {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #e040fb 0%, #7c4dff 50%, #ff4081 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 16px;
            color: #888;
            margin-bottom: 25px;
        }

        .tagline {
            font-size: 14px;
            color: #666;
            line-height: 1.8;
            margin-bottom: 35px;
        }

        .input-area {
            width: 100%;
            margin-bottom: 25px;
        }

        .input-label {
            display: block;
            font-size: 13px;
            color: #888;
            margin-bottom: 12px;
            text-align: left;
            letter-spacing: 1px;
        }

        .code-input {
            width: 100%;
            height: 54px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(180, 50, 120, 0.3);
            border-radius: 14px;
            padding: 0 20px;
            font-size: 16px;
            color: #f0f0f5;
            text-align: center;
            letter-spacing: 3px;
            outline: none;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .code-input:focus {
            border-color: #e040fb;
            box-shadow: 0 0 25px rgba(224, 64, 251, 0.25);
        }

        .code-input::placeholder {
            color: #555;
            letter-spacing: 2px;
        }

        .btn-primary {
            width: 100%;
            height: 54px;
            background: linear-gradient(135deg, #e040fb 0%, #7c4dff 100%);
            border: none;
            border-radius: 27px;
            color: #fff;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 30px rgba(124, 77, 255, 0.4);
            margin-bottom: 30px;
            letter-spacing: 2px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(124, 77, 255, 0.5);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .info-cards {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }

        .info-card {
            padding: 15px;
            background: rgba(180, 50, 120, 0.1);
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .info-card-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .info-card-text {
            font-size: 12px;
            color: #999;
        }

        .tips {
            width: 100%;
            padding: 20px;
            background: rgba(124, 77, 255, 0.08);
            border-radius: 14px;
            text-align: left;
            border: 1px solid rgba(124, 77, 255, 0.15);
        }

        .tips-title {
            font-size: 13px;
            color: #e040fb;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tips-text {
            font-size: 12px;
            color: #777;
            line-height: 1.9;
        }

        .quiz-page, .result-page {
            display: none;
            width: 100%;
            max-width: 440px;
            margin: 0 auto;
            padding: 15px;
        }

        .quiz-page.active, .result-page.active {
            display: block;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e040fb 0%, #ff4081 100%);
            border-radius: 3px;
            transition: width 0.4s ease;
        }

        .progress-text {
            font-size: 13px;
            color: #888;
        }

        .question-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 28px 22px;
            margin-bottom: 18px;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .question-number {
            font-size: 12px;
            color: #e040fb;
            margin-bottom: 15px;
            letter-spacing: 1px;
        }

        .question-text {
            font-size: 17px;
            line-height: 1.7;
            color: #f0f0f5;
            margin-bottom: 25px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .option {
            padding: 15px 18px;
            background: rgba(255, 255, 255, 0.02);
            border: 2px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            color: #ccc;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .option:hover {
            background: rgba(180, 50, 120, 0.15);
            border-color: rgba(180, 50, 120, 0.3);
            color: #fff;
        }

        .option.selected {
            background: rgba(180, 50, 120, 0.25);
            border-color: #e040fb;
            color: #fff;
        }

        .navigation {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }

        .nav-btn {
            flex: 1;
            height: 48px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 24px;
            color: #ccc;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: rgba(180, 50, 120, 0.2);
            border-color: rgba(180, 50, 120, 0.3);
            color: #fff;
        }

        .nav-btn:active {
            transform: scale(0.98);
        }

        .nav-btn.prev-btn:hover {
            background: rgba(124, 77, 255, 0.2);
            border-color: rgba(124, 77, 255, 0.3);
        }

        .nav-btn.next-btn {
            background: linear-gradient(135deg, #e040fb 0%, #7c4dff 100%);
            border: none;
            color: #fff;
        }

        .nav-btn.next-btn:hover {
            box-shadow: 0 5px 20px rgba(224, 64, 251, 0.3);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .nav-btn:disabled:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
            color: #ccc;
            box-shadow: none;
        }

        .result-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 22px;
            background: linear-gradient(135deg, #e040fb 0%, #ff4081 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .result-subtitle {
            font-size: 14px;
            color: #888;
        }

        .score-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 28px;
            margin-bottom: 18px;
            text-align: center;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .score-circle {
            width: 140px;
            height: 140px;
            margin: 0 auto 15px;
            border-radius: 50%;
            background: conic-gradient(#e040fb 0deg, #e040fb calc(var(--score) * 3.6deg), rgba(255,255,255,0.1) calc(var(--score) * 3.6deg), rgba(255,255,255,0.1) 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(224, 64, 251, 0.2);
        }

        .score-inner {
            width: 110px;
            height: 110px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1a1525 0%, #0d0d15 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .score-value {
            font-size: 42px;
            font-weight: 700;
            background: linear-gradient(135deg, #e040fb 0%, #ff4081 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-label {
            font-size: 11px;
            color: #888;
            letter-spacing: 1px;
        }

        .radar-container {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 18px;
            margin-bottom: 18px;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .radar-chart {
            width: 100%;
            height: 300px;
        }

        .dimensions {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 22px;
            margin-bottom: 18px;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .dimensions-title {
            font-size: 15px;
            color: #e040fb;
            margin-bottom: 18px;
            text-align: center;
            letter-spacing: 2px;
        }

        .dimension-item {
            margin-bottom: 16px;
        }

        .dimension-item:last-child {
            margin-bottom: 0;
        }

        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .dimension-name {
            font-size: 13px;
            color: #ccc;
        }

        .dimension-score {
            font-size: 13px;
            font-weight: 600;
            color: #ff4081;
        }

        .dimension-bar {
            height: 5px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 3px;
            overflow: hidden;
        }

        .dimension-fill {
            height: 100%;
            background: linear-gradient(90deg, #7c4dff 0%, #e040fb 50%, #ff4081 100%);
            border-radius: 3px;
            transition: width 0.6s ease;
        }

        .interpretation {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 22px;
            margin-bottom: 18px;
            border: 1px solid rgba(180, 50, 120, 0.15);
        }

        .interpretation-title {
            font-size: 15px;
            color: #e040fb;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .interpretation-text {
            font-size: 13px;
            color: #999;
            line-height: 1.9;
        }

        .actions {
            display: flex;
            gap: 12px;
            margin-top: 22px;
        }

        .btn-secondary {
            flex: 1;
            height: 48px;
            background: rgba(180, 50, 120, 0.15);
            border: 1px solid rgba(180, 50, 120, 0.25);
            border-radius: 24px;
            color: #f0f0f5;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(180, 50, 120, 0.25);
        }

        .btn-secondary:active {
            transform: scale(0.98);
        }

        .error-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(220, 40, 80, 0.95);
            color: #fff;
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            text-align: center;
            max-width: 85%;
        }

        .error-toast.show {
            opacity: 1;
        }

        @media (max-width: 400px) {
            .main-title { font-size: 26px; }
            .question-text { font-size: 16px; }
            .score-value { font-size: 36px; }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="container" id="homePage">
        <div class="home-content">
            <div class="logo-area">
                <div class="logo-icon">ğŸ­</div>
                <h1 class="main-title">é»‘æš—äººæ ¼æµ‹è¯•</h1>
                <p class="subtitle">æ·±åº¦å¿ƒç†åˆ†æ Â· 10ç»´äººæ ¼ç”»åƒ</p>
            </div>
            
            <p class="tagline">
                æ¢ç´¢ä½ å†…å¿ƒæ·±å¤„çš„<br>
                <span style="color: #e040fb;">æƒè°‹ã€æ¬²æœ›ä¸çœŸå®è‡ªæˆ‘</span>
            </p>
            
            <div class="input-area">
                <label class="input-label">è¯·è¾“å…¥å…‘æ¢ç </label>
                <input type="text" class="code-input" id="codeInput" 
                       placeholder="XXXX-XXXX-XXXX" maxlength="14" 
                       oninput="formatCode(this)">
            </div>
            
            <button class="btn-primary" id="startBtn" onclick="startTest()">
                å¼€å§‹æ¢ç´¢
            </button>
            
            <div class="info-cards">
                <div class="info-card">
                    <div class="info-card-icon">ğŸ“Š</div>
                    <div class="info-card-text">10ç»´åˆ†æ</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">âš¡</div>
                    <div class="info-card-text">ç§’å‡ºæŠ¥å‘Š</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">ğŸ”¬</div>
                    <div class="info-card-text">ä¸“ä¸šç®—æ³•</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">ğŸ¯</div>
                    <div class="info-card-text">ç²¾å‡†ç”»åƒ</div>
                </div>
            </div>
            
            <div class="tips">
                <div class="tips-title">ğŸ’¡ ä½¿ç”¨è¯´æ˜</div>
                <div class="tips-text">
                    1. è´­ä¹°åç›´æ¥ç‚¹å‡»é“¾æ¥è¿›å…¥<br>
                    2. ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å…‘æ¢ç <br>
                    3. ç‚¹å‡»å¼€å§‹æ¢ç´¢å³å¯æµ‹è¯•<br>
                    4. 24å°æ—¶å†…å¯é‡å¤æµ‹è¯•
                </div>
            </div>
        </div>
    </div>

    <div class="quiz-page" id="quizPage">
        <div class="quiz-header">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progressText">ç¬¬ 1 / 20 é¢˜</div>
        </div>
        
        <div class="question-card">
            <div class="question-number" id="questionNumber">é—®é¢˜ 1</div>
            <div class="question-text" id="questionText"></div>
            <div class="options" id="optionsContainer"></div>
            
            <div class="navigation">
                <button class="nav-btn prev-btn" id="prevBtn" onclick="prevQuestion()">â† ä¸Šä¸€é¢˜</button>
                <button class="nav-btn next-btn" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â†’</button>
            </div>
        </div>
    </div>

    <div class="result-page" id="resultPage">
        <div class="result-header">
            <h1 class="result-title">ä½ çš„é»‘æš—äººæ ¼ç”»åƒ</h1>
            <p class="result-subtitle" id="resultSubtitle"></p>
        </div>
        
        <div class="score-card">
            <div class="score-circle" id="scoreCircle" style="--score: 0">
                <div class="score-inner">
                    <div class="score-value" id="totalScore">0</div>
                    <div class="score-label">DARK INDEX</div>
                </div>
            </div>
        </div>
        
        <div class="radar-container">
            <div class="radar-chart" id="radarChart"></div>
        </div>
        
        <div class="dimensions">
            <div class="dimensions-title">ğŸ“ˆ å„ç»´åº¦åˆ†æ</div>
            <div id="dimensionsContainer"></div>
        </div>
        
        <div class="interpretation">
            <div class="interpretation-title">ğŸ”® ç»¼åˆè§£è¯»</div>
            <div class="interpretation-text" id="interpretationText"></div>
        </div>
        
        <div class="actions">
            <button class="btn-secondary" onclick="copyResult()">åˆ†äº«ç»“æœ</button>
            <button class="btn-secondary" onclick="goHome()">è¿”å›é¦–é¡µ</button>
        </div>
    </div>

    <div class="error-toast" id="errorToast"></div>

    <script>
        var VALID_CODES = {
            // æ¼”ç¤ºç ï¼ˆæµ‹è¯•ç”¨ï¼‰
            'TEST-1234-5678': { used: false, deviceId: null, activateTime: null },
            'FREE-0000-0001': { used: false, deviceId: null, activateTime: null },
            'DEMO-9999-9999': { used: false, deviceId: null, activateTime: null },
            
            // é”€å”®å…‘æ¢ç ï¼ˆA001æ‰¹æ¬¡ï¼‰
            'A001-0001-0001': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0002': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0003': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0004': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0005': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0006': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0007': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0008': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0009': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0010': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0011': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0012': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0013': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0014': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0015': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0016': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0017': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0018': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0019': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0020': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0021': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0022': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0023': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0024': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0025': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0026': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0027': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0028': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0029': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0030': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0031': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0032': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0033': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0034': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0035': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0036': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0037': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0038': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0039': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0040': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0041': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0042': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0043': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0044': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0045': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0046': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0047': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0048': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0049': { used: false, deviceId: null, activateTime: null },
            'A001-0001-0050': { used: false, deviceId: null, activateTime: null }
        };

        var questions = [
            {
                text: "ä½ æ˜¯å¦ä¼šä¸ºäº†è·å¾—æ›´å¤šèµ„æºæˆ–åˆ©ç›Šï¼Œè€Œä¸»åŠ¨ç–è¿œé‚£äº›'æ²¡ç”¨'çš„äººï¼Ÿ",
                dimensions: ['egoism', 'greed'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "å½“ä½ çœ‹åˆ°åˆ«äººæ‹¥æœ‰ä½ æ¸´æœ›çš„ä¸œè¥¿æ—¶ï¼Œä½ æ˜¯å¦ä¼šæ„Ÿåˆ°å¼ºçƒˆçš„å«‰å¦’å’Œä¸æ»¡ï¼Ÿ",
                dimensions: ['greed', 'narcissism'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ è®¤ä¸ºåœ¨ç«äº‰ä¸­ï¼Œ'å–„è‰¯'å’Œ'è¯šå®'å¾€å¾€æ˜¯å¤±è´¥çš„ä»£åè¯å—ï¼Ÿ",
                dimensions: ['machiavellianism', 'morality'],
                options: [
                    { text: "å®Œå…¨ä¸è®¤åŒ", score: 1 },
                    { text: "å¾ˆå°‘è®¤åŒ", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒè®¤åŒ", score: 4 },
                    { text: "å®Œå…¨è®¤åŒ", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦ç»å¸¸ä¸ºè‡ªå·±çš„ä¸å½“è¡Œä¸ºæ‰¾åˆ°'åˆç†'çš„å€Ÿå£ï¼Ÿ",
                dimensions: ['morality', 'psychopathy'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦è®¤ä¸ºï¼Œè‡ªå·±æ¯”å¤§å¤šæ•°äººéƒ½æ›´ä¼˜ç§€ã€æ›´æœ‰èµ„æ ¼è·å¾—æˆåŠŸï¼Ÿ",
                dimensions: ['narcissism', 'entitlement'],
                options: [
                    { text: "å®Œå…¨ä¸è®¤åŒ", score: 1 },
                    { text: "å¾ˆå°‘è®¤åŒ", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒè®¤åŒ", score: 4 },
                    { text: "å®Œå…¨è®¤åŒ", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦è§‰å¾—ï¼Œä¸–ç•Œåº”è¯¥å›´ç€ä½ è½¬ï¼Œè€Œåˆ«äººåº”è¯¥æ— æ¡ä»¶æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Ÿ",
                dimensions: ['entitlement', 'narcissism'],
                options: [
                    { text: "å®Œå…¨ä¸è®¤åŒ", score: 1 },
                    { text: "å¾ˆå°‘è®¤åŒ", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒè®¤åŒ", score: 4 },
                    { text: "å®Œå…¨è®¤åŒ", score: 5 }
                ]
            },
            {
                text: "å½“ä½ ä¼¤å®³äº†åˆ«äººï¼Œä½ æ˜¯å¦å¾ˆéš¾æ„Ÿåˆ°çœŸæ­£çš„æ„§ç–šæˆ–è‡ªè´£ï¼Ÿ",
                dimensions: ['psychopathy', 'morality'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œå¶å°”ä¼šæœ‰æƒ³çœ‹åˆ°ä»–äººç—›è‹¦æˆ–éš¾è¿‡çš„å†²åŠ¨ï¼Ÿ",
                dimensions: ['sadism', 'spitefulness'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "åœ¨åšå†³å®šæ—¶ï¼Œä½ æ˜¯å¦æ€»æ˜¯ä¼˜å…ˆè€ƒè™‘è‡ªå·±çš„åˆ©ç›Šï¼Œè€Œå¾ˆå°‘é¡¾åŠä»–äººæ„Ÿå—ï¼Ÿ",
                dimensions: ['selfish', 'egoism'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "å³ä½¿çŸ¥é“ä¼šä¼¤å®³åˆ°å¯¹æ–¹ï¼Œä½ æ˜¯å¦ä¹Ÿä¼šæ¯«ä¸çŠ¹è±«åœ°è¿½æ±‚è‡ªå·±æƒ³è¦çš„ä¸œè¥¿ï¼Ÿ",
                dimensions: ['spitefulness', 'greed'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦å–„äºç”¨'å–„æ„'çš„è°è¨€æ¥æ“æ§ä»–äººï¼Œè¾¾åˆ°è‡ªå·±çš„ç›®çš„ï¼Ÿ",
                dimensions: ['machiavellianism', 'sadism'],
                options: [
                    { text: "å®Œå…¨ä¸æ“…é•¿", score: 1 },
                    { text: "å¾ˆå°‘æ“…é•¿", score: 2 },
                    { text: "ä¸€èˆ¬", score: 3 },
                    { text: "æ¯”è¾ƒæ“…é•¿", score: 4 },
                    { text: "éå¸¸æ“…é•¿", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦è§‰å¾—å¤§å¤šæ•°äººéƒ½æ˜¯æ„šè ¢çš„ï¼Œå¾ˆå®¹æ˜“è¢«åˆ©ç”¨ï¼Ÿ",
                dimensions: ['machiavellianism', 'narcissism'],
                options: [
                    { text: "å®Œå…¨ä¸è®¤åŒ", score: 1 },
                    { text: "å¾ˆå°‘è®¤åŒ", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒè®¤åŒ", score: 4 },
                    { text: "å®Œå…¨è®¤åŒ", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦ç»å¸¸è§‰å¾—è§„åˆ™æ˜¯ä¸ºæ™®é€šäººåˆ¶å®šçš„ï¼Œè€Œä½ æœ‰ç‰¹æƒä¸éµå®ˆï¼Ÿ",
                dimensions: ['entitlement', 'machiavellianism'],
                options: [
                    { text: "å®Œå…¨ä¸è®¤åŒ", score: 1 },
                    { text: "å¾ˆå°‘è®¤åŒ", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒè®¤åŒ", score: 4 },
                    { text: "å®Œå…¨è®¤åŒ", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦ä¼šåœ¨åˆ«äººå›°éš¾æ—¶ï¼Œä¸ä»…ä¸å¸®å¿™ï¼Œåè€Œå¹¸ç¾ä¹ç¥¸ï¼Ÿ",
                dimensions: ['sadism', 'psychopathy'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦å¾ˆéš¾çœŸæ­£ç†è§£ä»–äººçš„æ„Ÿå—å’Œç—›è‹¦ï¼Ÿ",
                dimensions: ['psychopathy', 'selfish'],
                options: [
                    { text: "å®Œå…¨èƒ½ç†è§£", score: 1 },
                    { text: "å¤§å¤šèƒ½ç†è§£", score: 2 },
                    { text: "ä¸€èˆ¬", score: 3 },
                    { text: "è¾ƒå°‘ç†è§£", score: 4 },
                    { text: "å®Œå…¨ä¸èƒ½", score: 5 }
                ]
            },
            {
                text: "å½“ä½ è·å¾—æˆåŠŸæ—¶ï¼Œä½ æ˜¯å¦è§‰å¾—éƒ½æ˜¯è‡ªå·±çš„åŠŸåŠ³ï¼Œä¸ä»–äººæ— å…³ï¼Ÿ",
                dimensions: ['narcissism', 'selfish'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦ç»å¸¸è§‰å¾—åˆ«äººçš„é—®é¢˜å’Œçƒ¦æ¼å¾ˆæ— èŠï¼Œä¸å€¼å¾—ä½ å…³å¿ƒï¼Ÿ",
                dimensions: ['selfish', 'psychopathy'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦ä¼šè§‰å¾—ï¼Œä¸ºäº†'æ›´å¤§çš„åˆ©ç›Š'ï¼Œç‰ºç‰²å°‘æ•°äººæ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ï¼Ÿ",
                dimensions: ['machiavellianism', 'spitefulness'],
                options: [
                    { text: "å®Œå…¨ä¸æ¥å—", score: 1 },
                    { text: "å¾ˆå°‘æ¥å—", score: 2 },
                    { text: "ä¸­ç«‹", score: 3 },
                    { text: "æ¯”è¾ƒæ¥å—", score: 4 },
                    { text: "å®Œå…¨æ¥å—", score: 5 }
                ]
            },
            {
                text: "ä½ æ˜¯å¦æ¸´æœ›æ‹¥æœ‰æ›´å¤šçš„æƒåŠ›ã€é‡‘é’±æˆ–åœ°ä½ï¼Œå³ä½¿è¿™æ„å‘³ç€è¦ä¼¤å®³ä»–äººï¼Ÿ",
                dimensions: ['greed', 'entitlement'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            },
            {
                text: "å½“ä½ ä¸å–œæ¬¢ä¸€ä¸ªäººæ—¶ï¼Œä½ æ˜¯å¦ä¼šæƒ³åŠæ³•è®©ä»–/å¥¹åœ¨ç¤¾äº¤åœˆä¸­éš¾å ªæˆ–è¢«å­¤ç«‹ï¼Ÿ",
                dimensions: ['spitefulness', 'sadism'],
                options: [
                    { text: "å®Œå…¨ä¸ä¼š", score: 1 },
                    { text: "å¾ˆå°‘ä¼š", score: 2 },
                    { text: "å¶å°”ä¼š", score: 3 },
                    { text: "ç»å¸¸ä¼š", score: 4 },
                    { text: "å®Œå…¨ä¼š", score: 5 }
                ]
            }
        ];

        var dimensions = {
            egoism: { name: 'åˆ©å·±ä¸»ä¹‰', color: '#7c4dff' },
            greed: { name: 'è´ªå©ª', color: '#e040fb' },
            machiavellianism: { name: 'é©¬åŸºé›…ç»´åˆ©ä¸»ä¹‰', color: '#ff4081' },
            morality: { name: 'é“å¾·æ¨è„±', color: '#ff4081' },
            narcissism: { name: 'è‡ªæ‹', color: '#e040fb' },
            entitlement: { name: 'å¿ƒç†æƒåŠ›', color: '#7c4dff' },
            psychopathy: { name: 'ç²¾ç¥å˜æ€', color: '#ff4081' },
            sadism: { name: 'æ–½è™å€¾å‘', color: '#e040fb' },
            selfish: { name: 'è‡ªæˆ‘ä¸ºä¸­å¿ƒ', color: '#7c4dff' },
            spitefulness: { name: 'æ¶æ¯’å€¾å‘', color: '#ff4081' }
        };

        var currentQuestion = 0;
        var answers = [];
        var deviceId = null;
        var activationData = null;

        function generateDeviceId() {
            var components = [
                navigator.userAgent,
                navigator.language,
                screen.colorDepth,
                screen.width + 'x' + screen.height,
                new Date().getTimezoneOffset(),
                navigator.hardwareConcurrency || 0
            ];
            
            var hash = 0;
            for (var i = 0; i < components.length; i++) {
                var str = String(components[i]);
                for (var j = 0; j < str.length; j++) {
                    var char = str.charCodeAt(j);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
            }
            return 'DEV_' + Math.abs(hash).toString(16).toUpperCase();
        }

        function createStars() {
            var container = document.getElementById('particles');
            for (var i = 0; i < 40; i++) {
                var star = document.createElement('div');
                star.className = 'particle';
                star.style.left = (Math.random() * 100) + '%';
                star.style.top = (Math.random() * 100) + '%';
                star.style.width = (Math.random() * 4 + 2) + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = (Math.random() * 10) + 's';
                container.appendChild(star);
            }
        }

        window.onload = function() {
            createStars();
            deviceId = generateDeviceId();
            
            // 1. æ£€æŸ¥URLå‚æ•°ä¸­çš„å…‘æ¢ç ï¼ˆç”¨äºæ‰‹åŠ¨åˆ†å‘åœºæ™¯ï¼‰
            var urlParams = new URLSearchParams(window.location.search);
            var urlCode = urlParams.get('code');
            
            if (urlCode) {
                var codeInput = document.getElementById('codeInput');
                codeInput.value = urlCode.toUpperCase();
                codeInput.disabled = true;
                console.log('URLå…‘æ¢ç å·²è‡ªåŠ¨å¡«å……:', urlCode);
                return;
            }
            
            // 2. æ£€æŸ¥localStorageä¸­çš„æ¿€æ´»çŠ¶æ€ï¼ˆè¿”å›ç”¨æˆ·ï¼‰
            var savedData = localStorage.getItem('dark_test_activation');
            if (savedData) {
                try {
                    activationData = JSON.parse(savedData);
                    var now = Date.now();
                    var expireTime = 24 * 60 * 60 * 1000;
                    if (now - activationData.activateTime < expireTime) {
                        document.getElementById('codeInput').value = activationData.code;
                        document.getElementById('codeInput').disabled = true;
                        console.log('è¿”å›ç”¨æˆ·ï¼Œä½¿ç”¨å·²åˆ†é…çš„å…‘æ¢ç :', activationData.code);
                        return;
                    } else {
                        localStorage.removeItem('dark_test_activation');
                        activationData = null;
                    }
                } catch (e) {
                    console.error('è§£ææ¿€æ´»æ•°æ®å¤±è´¥', e);
                }
            }
            
            // 3. æ–°ç”¨æˆ·è‡ªåŠ¨åˆ†é…å…‘æ¢ç ï¼ˆå…¨è‡ªåŠ¨åœºæ™¯ï¼‰
            // å½“ç”¨æˆ·é€šè¿‡é€šç”¨é“¾æ¥è®¿é—®æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ†é…æœªä½¿ç”¨çš„å…‘æ¢ç 
            var unusedCode = findUnusedCode();
            if (unusedCode) {
                var success = assignCodeToUser(unusedCode);
                if (success) {
                    var codeInput = document.getElementById('codeInput');
                    codeInput.value = unusedCode;
                    codeInput.disabled = true;
                    console.log('ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å…‘æ¢ç :', unusedCode);
                } else {
                    console.error('å…‘æ¢ç åˆ†é…å¤±è´¥');
                }
            } else {
                console.warn('æ‰€æœ‰å…‘æ¢ç å·²åˆ†é…å®Œæ¯•');
            }
        };

        function formatCode(input) {
            var value = input.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
            if (value.length > 14) value = value.substring(0, 14);
            
            var parts = [];
            for (var i = 0; i < value.length; i += 4) {
                parts.push(value.substring(i, i + 4));
            }
            
            input.value = parts.join('-').substring(0, 19);
        }

        // æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæœªä½¿ç”¨çš„å…‘æ¢ç 
        function findUnusedCode() {
            var keys = Object.keys(VALID_CODES);
            for (var i = 0; i < keys.length; i++) {
                var key = keys[i];
                if (!VALID_CODES[key].used) {
                    return key;
                }
            }
            return null;
        }

        // åˆ†é…å…‘æ¢ç ç»™æ–°ç”¨æˆ·
        function assignCodeToUser(code) {
            if (!VALID_CODES.hasOwnProperty(code)) return false;
            
            var codeData = VALID_CODES[code];
            if (codeData.used) return false;
            
            codeData.used = true;
            codeData.deviceId = deviceId;
            codeData.activateTime = Date.now();
            
            activationData = {
                code: code,
                deviceId: deviceId,
                activateTime: Date.now()
            };
            
            localStorage.setItem('dark_test_activation', JSON.stringify(activationData));
            return true;
        }

        function showError(message) {
            var toast = document.getElementById('errorToast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(function() {
                toast.classList.remove('show');
            }, 3000);
        }

        function startTest() {
            var code = document.getElementById('codeInput').value.trim();
            
            if (!code) {
                showError('è¯·è¾“å…¥å…‘æ¢ç ');
                return;
            }
            
            if (!VALID_CODES.hasOwnProperty(code)) {
                if (activationData && activationData.code === code) {
                    startQuiz(code);
                    return;
                }
                showError('å…‘æ¢ç æ— æ•ˆï¼Œè¯·æ£€æŸ¥åé‡æ–°è¾“å…¥');
                return;
            }
            
            var codeData = VALID_CODES[code];
            
            if (codeData.used) {
                if (codeData.deviceId === deviceId) {
                    var now = Date.now();
                    var expireTime = 24 * 60 * 60 * 1000;
                    if (now - codeData.activateTime < expireTime) {
                        startQuiz(code);
                        return;
                    } else {
                        showError('å…‘æ¢ç å·²è¿‡æœŸï¼Œè¯·é‡æ–°è´­ä¹°');
                        return;
                    }
                } else {
                    showError('è¯¥å…‘æ¢ç å·²åœ¨å…¶ä»–è®¾å¤‡ä¸Šä½¿ç”¨');
                    return;
                }
            }
            
            codeData.used = true;
            codeData.deviceId = deviceId;
            codeData.activateTime = Date.now();
            
            activationData = {
                code: code,
                deviceId: deviceId,
                activateTime: Date.now()
            };
            localStorage.setItem('dark_test_activation', JSON.stringify(activationData));
            
            startQuiz(code);
        }

        function startQuiz(code) {
            currentQuestion = 0;
            answers = new Array(questions.length).fill(null);
            
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('quizPage').classList.add('active');
            
            updateProgress();
            showQuestion(0);
        }

        function updateProgress() {
            var progress = ((currentQuestion) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = 
                'ç¬¬ ' + (currentQuestion + 1) + ' / ' + questions.length + ' é¢˜';
        }

        function showQuestion(index) {
            var question = questions[index];
            
            document.getElementById('questionNumber').textContent = 'é—®é¢˜ ' + (index + 1);
            document.getElementById('questionText').textContent = question.text;
            
            var optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach(function(option, optIndex) {
                var optionEl = document.createElement('button');
                optionEl.className = 'option';
                if (answers[index] === option.score) {
                    optionEl.classList.add('selected');
                }
                optionEl.textContent = option.text;
                optionEl.onclick = (function(score) {
                    return function() {
                        selectOption(score);
                    };
                })(option.score);
                optionsContainer.appendChild(optionEl);
            });
            
            // Update navigation buttons
            updateNavButtons();
        }

        function selectOption(score) {
            answers[currentQuestion] = score;
            
            var options = document.querySelectorAll('.option');
            options.forEach(function(el, index) {
                if (index === score - 1) {
                    el.classList.add('selected');
                } else {
                    el.classList.remove('selected');
                }
            });
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                updateProgress();
                showQuestion(currentQuestion);
                updateNavButtons();
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                updateProgress();
                showQuestion(currentQuestion);
                updateNavButtons();
            } else {
                // Check if all questions are answered
                var allAnswered = answers.every(function(a) { return a !== null; });
                if (allAnswered) {
                    calculateResult();
                } else {
                    showError('è¯·å…ˆå®Œæˆæ‰€æœ‰é¢˜ç›®');
                }
            }
        }

        function updateNavButtons() {
            var prevBtn = document.getElementById('prevBtn');
            var nextBtn = document.getElementById('nextBtn');
            
            // Update prev button
            prevBtn.disabled = currentQuestion === 0;
            
            // Update next button text
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = 'å®Œæˆæµ‹è¯• â†’';
            } else {
                nextBtn.textContent = 'ä¸‹ä¸€é¢˜ â†’';
            }
        }

        function calculateResult() {
            var dimensionScores = {};
            var dimensionCounts = {};
            
            Object.keys(dimensions).forEach(function(key) {
                dimensionScores[key] = 0;
                dimensionCounts[key] = 0;
            });
            
            questions.forEach(function(question, index) {
                var score = answers[index];
                if (score !== null) {
                    question.dimensions.forEach(function(dim) {
                        dimensionScores[dim] += score;
                        dimensionCounts[dim]++;
                    });
                }
            });
            
            var finalScores = {};
            Object.keys(dimensions).forEach(function(key) {
                var avg = dimensionCounts[key] > 0 ? dimensionScores[key] / dimensionCounts[key] : 0;
                finalScores[key] = Math.round((avg - 1) / 4 * 100);
            });
            
            var totalScore = Math.round(
                Object.values(finalScores).reduce(function(a, b) {
                    return a + b;
                }, 0) / Object.keys(finalScores).length
            );
            
            showResult(totalScore, finalScores);
        }

        function showResult(totalScore, dimensionScores) {
            document.getElementById('quizPage').classList.remove('active');
            document.getElementById('resultPage').classList.add('active');
            
            document.getElementById('totalScore').textContent = totalScore + '%';
            document.getElementById('scoreCircle').style.setProperty('--score', totalScore);
            
            var level = '';
            if (totalScore < 25) {
                level = 'é˜³å…‰çº¯çœŸå‹';
            } else if (totalScore < 45) {
                level = 'ç°å®ç†æ€§å‹';
            } else if (totalScore < 65) {
                level = 'ç²¾æ˜ç­–ç•¥å‹';
            } else if (totalScore < 80) {
                level = 'æƒè°‹æ“æ§å‹';
            } else {
                level = 'æš—é»‘å±é™©å‹';
            }
            document.getElementById('resultSubtitle').textContent = level;
            
            renderRadarChart(dimensionScores);
            renderDimensions(dimensionScores);
            renderInterpretation(totalScore, dimensionScores);
        }

        function renderRadarChart(scores) {
            var chartDom = document.getElementById('radarChart');
            var chart = echarts.init(chartDom);
            
            var indicator = Object.keys(dimensions).map(function(key) {
                return { name: dimensions[key].name, max: 100 };
            });
            
            var data = Object.keys(dimensions).map(function(key) {
                return scores[key];
            });
            
            var option = {
                backgroundColor: 'transparent',
                tooltip: {},
                radar: {
                    indicator: indicator,
                    shape: 'polygon',
                    splitNumber: 4,
                    axisName: { color: '#999', fontSize: 11 },
                    splitLine: { lineStyle: { color: 'rgba(180, 50, 120, 0.2)' } },
                    splitArea: { show: false },
                    axisLine: { lineStyle: { color: 'rgba(180, 50, 120, 0.3)' } }
                },
                series: [{
                    type: 'radar',
                    data: [{
                        value: data,
                        name: 'ç»´åº¦å¾—åˆ†',
                        areaStyle: { color: 'rgba(224, 64, 251, 0.3)' },
                        lineStyle: { color: '#e040fb', width: 2 },
                        itemStyle: { color: '#e040fb' }
                    }]
                }]
            };
            
            chart.setOption(option);
            window.addEventListener('resize', function() { chart.resize(); });
        }

        function renderDimensions(scores) {
            var container = document.getElementById('dimensionsContainer');
            container.innerHTML = '';
            
            Object.keys(dimensions).forEach(function(key) {
                var dim = dimensions[key];
                var score = scores[key];
                
                var item = document.createElement('div');
                item.className = 'dimension-item';
                item.innerHTML = 
                    '<div class="dimension-header">' +
                    '<span class="dimension-name" style="color:' + dim.color + '">' + dim.name + '</span>' +
                    '<span class="dimension-score">' + score + '</span>' +
                    '</div>' +
                    '<div class="dimension-bar">' +
                    '<div class="dimension-fill" style="width: ' + score + '%"></div>' +
                    '</div>';
                container.appendChild(item);
            });
        }

        function renderInterpretation(totalScore, scores) {
            var interpretations = [];
            
            if (scores.egoism > 50) interpretations.push('åˆ©å·±ä¸»ä¹‰');
            if (scores.greed > 60) interpretations.push('è´ªå©ª');
            if (scores.machiavellianism > 55) interpretations.push('é©¬åŸºé›…ç»´åˆ©ä¸»ä¹‰');
            if (scores.morality > 50) interpretations.push('é“å¾·æ¨è„±');
            if (scores.narcissism > 50) interpretations.push('è‡ªæ‹');
            if (scores.entitlement > 50) interpretations.push('å¿ƒç†æƒåŠ›');
            if (scores.psychopathy > 45) interpretations.push('ç²¾ç¥å˜æ€');
            if (scores.sadism > 40) interpretations.push('æ–½è™å€¾å‘');
            if (scores.selfish > 50) interpretations.push('è‡ªæˆ‘ä¸ºä¸­å¿ƒ');
            if (scores.spitefulness > 40) interpretations.push('æ¶æ¯’å€¾å‘');
            
            var text = '';
            if (totalScore < 25) {
                text = 'ä½ çš„é»‘æš—äººæ ¼æŒ‡æ•°ä»…ä¸º ' + totalScore + '%ï¼Œæ•´ä½“åå‘é˜³å…‰å’Œå–„ã€‚ä½ æ˜¯ä¸€ä¸ªçœŸè¯šã€å¯Œæœ‰åŒç†å¿ƒçš„äººï¼Œå¾ˆéš¾åšå‡ºä¼¤å®³ä»–äººçš„äº‹æƒ…ã€‚ä½ çš„ä¸–ç•Œå……æ»¡äº†ä¿¡ä»»å’Œå–„æ„ï¼Œè¿™æ˜¯éå¸¸çè´µçš„å“è´¨ã€‚';
            } else if (totalScore < 45) {
                text = 'ä½ çš„é»‘æš—äººæ ¼æŒ‡æ•°ä¸º ' + totalScore + '%ï¼Œå¤„äºæ­£å¸¸åé«˜çš„æ°´å¹³ã€‚ä½ å…·å¤‡ä¸€å®šçš„ç°å®ä¸»ä¹‰å’Œè‡ªæˆ‘ä¿æŠ¤æ„è¯†ï¼Œä½†å†…å¿ƒä»ä¿æŒç€åŸºæœ¬çš„å–„è‰¯å’Œé“å¾·åº•çº¿ã€‚';
            } else if (totalScore < 65) {
                text = 'ä½ çš„é»‘æš—äººæ ¼æŒ‡æ•°ä¸º ' + totalScore + '%ï¼Œæ˜¾ç¤ºå‡ºæ˜æ˜¾çš„ç°å®ä¸»ä¹‰å€¾å‘ã€‚ä½ æ‡‚å¾—åœ¨é€‚å½“çš„æ—¶å€™è¿ç”¨ç­–ç•¥æ¥ä¿æŠ¤è‡ªå·±å’Œäº‰å–åˆ©ç›Šï¼Œä½†å¹¶éå®Œå…¨ä¸é¡¾ä»–äººæ„Ÿå—ã€‚';
            } else if (totalScore < 80) {
                text = 'ä½ çš„é»‘æš—äººæ ¼æŒ‡æ•°é«˜è¾¾ ' + totalScore + '%ï¼Œè¡¨æ˜ä½ å†…å¿ƒæ·±å¤„æœ‰ç€å¼ºçƒˆçš„æ“æ§æ¬²å’Œå æœ‰æ¬²ã€‚ä½ å–„äºåˆ©ç”¨ä»–äººä¸ºè‡ªå·±çš„ç›®æ ‡æœåŠ¡ï¼Œåœ¨ç«äº‰ä¸­å¾€å¾€å æ®ä¼˜åŠ¿ã€‚';
            } else {
                text = 'ä½ çš„é»‘æš—äººæ ¼æŒ‡æ•°çˆ†è¡¨ï¼Œè¾¾åˆ° ' + totalScore + '%ï¼è¿™æ˜¯ä¸€ä¸ªæé«˜çš„åˆ†æ•°ï¼Œè¡¨æ˜ä½ åœ¨å¤šä¸ªç»´åº¦ä¸Šéƒ½è¡¨ç°å‡ºæ˜æ˜¾çš„é»‘æš—äººæ ¼ç‰¹å¾ã€‚';
            }
            
            if (interpretations.length > 0) {
                text += '\n\nä½ çš„çªå‡ºç‰¹å¾ï¼š' + interpretations.join('ã€');
            }
            
            document.getElementById('interpretationText').textContent = text;
        }

        function copyResult() {
            var score = document.getElementById('totalScore').textContent;
            var level = document.getElementById('resultSubtitle').textContent;
            var text = 'é»‘æš—äººæ ¼æµ‹è¯•\nå¾—åˆ†ï¼š' + score + '\nç±»å‹ï¼š' + level + '\n10ç»´æ·±åº¦åˆ†æï¼Œæ­ç¤ºçœŸå®è‡ªæˆ‘';
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    showError('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                });
            } else {
                showError('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            }
        }

        function goHome() {
            document.getElementById('resultPage').classList.remove('active');
            document.getElementById('homePage').style.display = 'flex';
        }
    </script>
</body>
</html>
